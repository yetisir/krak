version: 2.1

jobs:
  build:
    docker:
      - image: pymesh/pymesh:py3.6-slim
    steps:
      - checkout
      - restore_cache:
          keys:
            - deps-{{ checksum "requirements.txt" }}
      - run: apt update && apt -y install libstdc++6 python-qt4 libgl1-mesa-glx
      - run: python -m pip install -r requirements.txt
      - save_cache:
          key: deps
          paths:
            - /usr/local/lib/python3.6/site-packages 
      - run: python -m pip install -e .
      - run: pytest --flake8 --cov=krak 
